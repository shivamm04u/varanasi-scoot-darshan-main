# ðŸ”¥ **COMPLETE FIREBASE BACKEND INTEGRATION FOR REPLIT - FINAL PROMPT**

Add this **COMPLETE FIREBASE SECTION** to your existing Replit Master Prompt (or use standalone):

---

```text
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ðŸ”¥ FIREBASE BACKEND + SECURITY ENGINEER IMPLEMENTATION
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

You are a BACKEND AND SECURITY ENGINEER implementing enterprise-grade Firebase backend WITHOUT changing any frontend UI.

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ðŸŽ¯ MISSION STATEMENT
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

IMPLEMENT:
âœ… Firebase Firestore for storing user reviews/testimonials
âœ… Firebase Authentication for secure admin login
âœ… Admin-only access to dashboard (/admin/*)
âœ… Public users can submit reviews (no authentication required)
âœ… Public users can view ONLY approved reviews
âœ… Admins can approve/reject/delete reviews
âœ… Production-safe Firestore security rules
âœ… Vercel and Replit compatible deployment
âœ… Environment variables for all sensitive data
âœ… Zero downtime, zero security vulnerabilities

CRITICAL RULE:
âŒ NO frontend UI changes whatsoever
âŒ NO design modifications
âŒ NO layout changes
âœ… ONLY backend logic and database integration
âœ… Existing components remain visually identical

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ðŸ“‹ REQUIREMENTS CHECKLIST
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

AUTHENTICATION:
âœ… Firebase Authentication (Email/Password provider only)
âœ… Custom claims for admin role verification
âœ… Protected routes for admin panel
âœ… Session persistence with localStorage
âœ… Auto-logout after 2 hours of inactivity
âœ… Brute-force protection (max 5 login attempts)

DATABASE:
âœ… Firestore for reviews, bookings, settings, places
âœ… Server-side timestamp validation
âœ… Input sanitization and validation
âœ… Optimized indexes for queries
âœ… Backup and restore capability

SECURITY:
âœ… Production-safe Firestore security rules
âœ… Role-based access control (RBAC)
âœ… XSS prevention (input sanitization)
âœ… CSRF protection
âœ… Rate limiting on public endpoints
âœ… No sensitive data exposed to client

DEPLOYMENT:
âœ… Works on Replit (Node.js environment)
âœ… Works on Vercel (serverless functions)
âœ… Environment variables in Replit Secrets
âœ… Firebase config not hardcoded
âœ… Service account key stored securely

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ðŸ”§ STEP 1: FIREBASE PROJECT SETUP (COMPLETE GUIDE)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1.1 CREATE FIREBASE PROJECT:

1. Go to: https://console.firebase.google.com/ 
2. Click "Add project"
3. Project name: "baba-banarasi-production"
4. Project ID: baba-banarasi-prod (or auto-generated)
5. Google Analytics: Enable (recommended for tracking)
6. Analytics location: India
7. Click "Create project"
8. Wait for project creation (30-60 seconds)

1.2 ENABLE FIRESTORE DATABASE:

1. In Firebase Console, click "Firestore Database" (left sidebar)
2. Click "Create database"
3. Choose: "Start in production mode" 
   (We'll add custom rules manually for security)
4. Database location: asia-south1 (Mumbai, India) 
   âš ï¸ Choose closest to target audience for low latency
5. Click "Enable"
6. Wait for database to be created

1.3 ENABLE AUTHENTICATION:

1. Click "Authentication" (left sidebar)
2. Click "Get started"
3. Go to "Sign-in method" tab
4. Click "Email/Password" row
5. Toggle "Enable" to ON
6. Toggle "Email link (passwordless sign-in)" to OFF (not needed)
7. Click "Save"

1.4 CREATE ADMIN USERS:

1. In Authentication, go to "Users" tab
2. Click "Add user" button

Admin User 1 (Super Admin):
- Email: admin@bababanarasi.com
- Password: BabaAdmin@2025!Secure
- Click "Add user"
- âš ï¸ Copy the UID (e.g., "xyz123abc456...")
- Save UID for later (needed for custom claims)

Admin User 2 (Business Owner):
- Email: anshumanjha3333@gmail.com
- Password: Anshuman@2025!Secure
- Click "Add user"
- âš ï¸ Copy the UID
- Save UID for later

1.5 SET CUSTOM ADMIN CLAIMS:

We need to mark these users as admins using Firebase Admin SDK.

Download Service Account Key:
1. Click gear icon âš™ï¸ > "Project settings"
2. Go to "Service accounts" tab
3. Click "Generate new private key"
4. Click "Generate key" (downloads JSON file)
5. âš ï¸ CRITICAL: Save this file as `serviceAccountKey.json`
6. âš ï¸ NEVER commit this to Git (add to .gitignore)

Create script to set admin claims:

FILE: server/utils/setAdminClaims.js

```javascript
const admin = require('firebase-admin');
const serviceAccount = require('./serviceAccountKey.json');

// Initialize Firebase Admin SDK
admin.initializeApp({
  credential: admin.credential.cert(serviceAccount)
});

// Function to set admin custom claims
async function setAdminClaim(uid, email, role) {
  try {
    // Set custom claims
    await admin.auth().setCustomUserClaims(uid, {
      admin: true,
      role: role,
      accessLevel: role === 'super_admin' ? 'full' : 'limited'
    });
    
    console.log(`âœ… SUCCESS: Admin claim set for ${email}`);
    console.log(`   UID: ${uid}`);
    console.log(`   Role: ${role}`);
    console.log(`   Custom claims: { admin: true, role: "${role}" }`);
  } catch (error) {
    console.error(`âŒ ERROR setting claim for ${email}:`, error.message);
  }
}

// Main function to set all admin claims
async function setupAdminClaims() {
  console.log('\nðŸ” Setting up admin custom claims...\n');
  
  // âš ï¸ REPLACE THESE UIDs with actual UIDs from Firebase Console
  const admins = [
    {
      uid: 'REPLACE_WITH_ADMIN1_UID',
      email: 'admin@bababanarasi.com',
      role: 'super_admin'
    },
    {
      uid: 'REPLACE_WITH_ADMIN2_UID',
      email: 'anshumanjha3333@gmail.com',
      role: 'admin'
    }
  ];
  
  // Set claims for all admins
  for (const admin of admins) {
    await setAdminClaim(admin.uid, admin.email, admin.role);
  }
  
  console.log('\nâœ… All admin claims set successfully!');
  console.log('ðŸ‘‰ Users can now login with admin privileges\n');
  process.exit(0);
}

// Run the setup
setupAdminClaims().catch(error => {
  console.error('âŒ Fatal error:', error);
  process.exit(1);
});
```

Run this script ONCE:
```bash
cd server/utils
node setAdminClaims.js
```

You should see:
```
ðŸ” Setting up admin custom claims...

âœ… SUCCESS: Admin claim set for admin@bababanarasi.com
   UID: xyz123abc456
   Role: super_admin
   Custom claims: { admin: true, role: "super_admin" }

âœ… SUCCESS: Admin claim set for anshumanjha3333@gmail.com
   UID: abc789def012
   Role: admin
   Custom claims: { admin: true, role: "admin" }

âœ… All admin claims set successfully!
ðŸ‘‰ Users can now login with admin privileges
```

1.6 GET FIREBASE WEB CONFIG:

1. In Firebase Console, click gear icon âš™ï¸ > "Project settings"
2. Scroll to "Your apps" section
3. Click web icon (</>) "Add app"
4. App nickname: "Baba Banarasi Website"
5. Check "Also set up Firebase Hosting" (optional)
6. Click "Register app"
7. Copy the firebaseConfig object:

```javascript
const firebaseConfig = {
  apiKey: "AIzaSyXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX",
  authDomain: "baba-banarasi-prod.firebaseapp.com",
  projectId: "baba-banarasi-prod",
  storageBucket: "baba-banarasi-prod.appspot.com",
  messagingSenderId: "123456789012",
  appId: "1:123456789012:web:abcdef123456789",
  measurementId: "G-XXXXXXXXXX"
};
```

âš ï¸ Save these values - we'll add them to Replit Secrets

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ðŸ” STEP 2: REPLIT ENVIRONMENT VARIABLES
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

In Replit, click ðŸ”’ "Secrets" (left sidebar) and add:

FRONTEND FIREBASE CONFIG (Public - Safe to Expose):
```
Key: VITE_FIREBASE_API_KEY
Value: AIzaSyXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

Key: VITE_FIREBASE_AUTH_DOMAIN
Value: baba-banarasi-prod.firebaseapp.com

Key: VITE_FIREBASE_PROJECT_ID
Value: baba-banarasi-prod

Key: VITE_FIREBASE_STORAGE_BUCKET
Value: baba-banarasi-prod.appspot.com

Key: VITE_FIREBASE_MESSAGING_SENDER_ID
Value: 123456789012

Key: VITE_FIREBASE_APP_ID
Value: 1:123456789012:web:abcdef123456789

Key: VITE_FIREBASE_MEASUREMENT_ID
Value: G-XXXXXXXXXX
```

BACKEND ADMIN SDK (KEEP SECRET - NEVER EXPOSE):
```
Key: FIREBASE_ADMIN_PROJECT_ID
Value: baba-banarasi-prod

Key: FIREBASE_ADMIN_CLIENT_EMAIL
Value: firebase-adminsdk-xxxxx@baba-banarasi-prod.iam.gserviceaccount.com

Key: FIREBASE_ADMIN_PRIVATE_KEY
Value: -----BEGIN PRIVATE KEY-----\nMIIEvQIBADANBgkqhki...(very long)...\n-----END PRIVATE KEY-----\n
âš ï¸ Copy from serviceAccountKey.json "private_key" field
âš ï¸ Keep the \n characters (newlines)
```

CONTACT INFO (For Easy Access):
```
Key: CONTACT_PHONE
Value: +91 79913 01043

Key: CONTACT_EMAIL
Value: anshumanjha3333@gmail.com

Key: CONTACT_INSTAGRAM
Value: @baba_banarasi10
```

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ðŸ—„ï¸ STEP 3: FIRESTORE DATABASE SCHEMA (PRODUCTION-GRADE)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

COLLECTION 1: testimonials (User Reviews)

Document Structure:
```javascript
{
  // Auto-generated by Firestore
  id: "auto-generated-document-id",
  
  // Customer Information
  customer_name: "Sarah Johnson", // Required, min 2 chars
  customer_email: "sarah@email.com", // Optional, validated format
  customer_phone: "+1234567890", // Optional
  customer_avatar: "https://storage.googleapis.../photo.jpg", // Optional, uploaded image URL or null
  
  // Review Content
  rating: 5, // Required, Integer 1-5 only
  review_title: "Best way to explore Varanasi!", // Optional, max 100 chars
  review_text: "Baba Banarasi made my Varanasi trip...", // Required, min 50 chars, max 1000
  
  // Tour Information
  tour_taken: "Full Day Solo Scooter Darshan", // Required, string
  booking_date: Timestamp, // Optional, when they took the tour
  
  // Admin Moderation
  is_approved: false, // Boolean, default false (admin must approve)
  is_featured: false, // Boolean, admin can mark as featured (shows first)
  
  // Metadata
  source: "website", // String: "website", "google", "instagram", "facebook"
  helpful_votes: 0, // Integer, increments when users click "helpful"
  
  // Timestamps (Server-side)
  created_at: Timestamp, // Server timestamp when submitted
  updated_at: Timestamp // Server timestamp on any update
}
```

Firestore Indexes (Create These for Performance):

In Firebase Console > Firestore > Indexes:

1. Composite Index 1:
   - Collection: testimonials
   - Fields:
     â€¢ is_approved (Ascending)
     â€¢ created_at (Descending)
   - Query scope: Collection
   
2. Composite Index 2:
   - Collection: testimonials
   - Fields:
     â€¢ is_approved (Ascending)
     â€¢ is_featured (Descending)
     â€¢ created_at (Descending)
   
3. Composite Index 3:
   - Collection: testimonials
   - Fields:
     â€¢ is_approved (Ascending)
     â€¢ rating (Descending)
     â€¢ created_at (Descending)

COLLECTION 2: bookings (Customer Bookings)

Document Structure:
```javascript
{
  id: "auto-generated-document-id",
  
  // Customer Information
  customer_name: "John Doe", // Required
  phone: "+917991301043", // Required, validated format
  email: "john@email.com", // Optional
  
  // Booking Details
  tour_date: Timestamp, // Required, must be today or future
  tour_type: "full_day", // Required, enum: "full_day", "morning", "afternoon"
  number_of_people: 1, // Required, Integer 1-4
  special_requests: "Need vegetarian food recommendations", // Optional, max 500 chars
  
  // Booking Status
  status: "pending", // Required, enum: "pending", "confirmed", "completed", "cancelled"
  total_amount: 1999, // Required, Integer (in rupees)
  
  // Admin Notes
  admin_notes: "", // Optional, admin can add notes
  
  // Timestamps
  created_at: Timestamp, // Server timestamp
  updated_at: Timestamp
}
```

COLLECTION 3: settings (Site Settings - Admin Editable)

Document ID Structure (each setting is a document):

Document ID: "contact_info"
```javascript
{
  phone: "+91 79913 01043",
  email: "anshumanjha3333@gmail.com",
  instagram: "@baba_banarasi10",
  instagram_url: "https://instagram.com/baba_banarasi10 ",
  whatsapp: "+91 79913 01043",
  whatsapp_link: "https://wa.me/917991301043?text=Hi ...",
  location: "Assi Ghat Area, Varanasi - 221005, UP, India",
  updated_at: Timestamp,
  updated_by: "admin@bababanarasi.com"
}
```

Document ID: "hero_section"
```javascript
{
  title: "Baba Banarasi â€“ Solo Scooter Darshan",
  tagline: "Don't just see Banaras, feel it.",
  cta_text: "Book Your Darshan",
  starting_price: 1999,
  background_image: "https://storage.googleapis.../hero.jpg",
  updated_at: Timestamp
}
```

Document ID: "about_section"
```javascript
{
  heading: "Why Choose Baba Banarasi?",
  description: "Solo scooter darshan with local guide...",
  benefits: [
    "No walking fatigue",
    "Saves time and energy",
    "100% safe for solo travelers",
    "Budget-friendly â‚¹1,999"
  ],
  updated_at: Timestamp
}
```

COLLECTION 4: places (25 Sacred Places)

Document Structure:
```javascript
{
  id: "assi-ghat",
  name: "Assi Ghat",
  slug: "assi-ghat",
  category: "ghat", // "temple", "ghat", "heritage", "buddhist"
  description: "Southernmost ghat...", // Short, 100-150 chars
  detailed_description: "Assi Ghat is one of...", // Long, 200-500 words
  image_url: "https://images.unsplash.com/.../assi-ghat.jpg ",
  gallery_images: [
    "https://images.unsplash.../photo1.jpg",
    "https://images.unsplash.../photo2.jpg",
    "https://images.unsplash.../photo3.jpg"
  ],
  location_address: "Assi Ghat Road, Varanasi, UP 221005",
  google_maps_link: "https://goo.gl/maps/AssiGhatVaranasi ",
  latitude: 25.2820,
  longitude: 82.9990,
  best_time_to_visit: "Early morning 5-7 AM",
  entry_fee: "Free",
  opening_hours: "24 hours",
  historical_significance: "Mentioned in ancient scriptures...",
  spiritual_importance: "Believed to be confluence point...",
  tips_for_visitors: [
    "Best visited during sunrise",
    "Wear modest clothing",
    "Photography allowed"
  ],
  included_in_tour: true,
  tour_session: "morning", // "morning", "afternoon", null
  display_order: 1,
  is_active: true,
  created_at: Timestamp,
  updated_at: Timestamp
}
```

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ðŸ”’ STEP 4: FIRESTORE SECURITY RULES (PRODUCTION-SAFE)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

In Firebase Console > Firestore Database > Rules tab, paste:

```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // HELPER FUNCTIONS (Security Utilities)
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    // Check if user is authenticated
    function isSignedIn() {
      return request.auth != null;
    }
    
    // Check if user is an admin (has custom claim)
    function isAdmin() {
      return isSignedIn() 
        && request.auth.token.admin == true;
    }
    
    // Check if user is super admin
    function isSuperAdmin() {
      return isSignedIn() 
        && request.auth.token.admin == true 
        && request.auth.token.role == 'super_admin';
    }
    
    // Validate email format
    function isValidEmail(email) {
      return email.matches('^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$');
    }
    
    // Validate phone format (Indian +91 format)
    function isValidPhone(phone) {
      return phone.matches('^\\+?[0-9]{10,15}$');
    }
    
    // Check if timestamp is server-side (prevents client manipulation)
    function isServerTimestamp(timestamp) {
      return timestamp == request.time;
    }
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // TESTIMONIALS COLLECTION (User Reviews)
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    match /testimonials/{testimonialId} {
      
      // PUBLIC READ: Only approved testimonials visible to everyone
      allow read: if resource.data.is_approved == true;
      
      // PUBLIC CREATE: Anyone can submit a review (no auth required)
      allow create: if 
        // Allow unauthenticated users to submit
        request.auth == null
        
        // Validation: Customer name required, min 2 characters
        && request.resource.data.customer_name is string
        && request.resource.data.customer_name.size() >= 2
        && request.resource.data.customer_name.size() <= 100
        
        // Validation: Email optional, but if provided must be valid
        && (!('customer_email' in request.resource.data) 
            || request.resource.data.customer_email == null
            || isValidEmail(request.resource.data.customer_email))
        
        // Validation: Phone optional, but if provided must be valid
        && (!('customer_phone' in request.resource.data)
            || request.resource.data.customer_phone == null
            || isValidPhone(request.resource.data.customer_phone))
        
        // Validation: Rating required, must be 1-5
        && request.resource.data.rating is int
        && request.resource.data.rating >= 1
        && request.resource.data.rating <= 5
        
        // Validation: Review text required, min 50 chars, max 1000
        && request.resource.data.review_text is string
        && request.resource.data.review_text.size() >= 50
        && request.resource.data.review_text.size() <= 1000
        
        // Validation: Review title optional, max 100 chars
        && (!('review_title' in request.resource.data)
            || request.resource.data.review_title == null
            || request.resource.data.review_title.size() <= 100)
        
        // Security: Must start as unapproved (admin approval required)
        && request.resource.data.is_approved == false
        && request.resource.data.is_featured == false
        
        // Security: Created timestamp must be server-side
        && request.resource.data.created_at == request.time
        
        // Security: Helpful votes must start at 0
        && request.resource.data.helpful_votes == 0;
      
      // ADMIN READ: Admins can read ALL testimonials (approved + pending)
      allow read: if isAdmin();
      
      // ADMIN UPDATE: Admins can approve, feature, edit testimonials
      allow update: if isAdmin()
        // Admins can only update these fields:
        && request.resource.data.diff(resource.data).affectedKeys()
          .hasOnly(['is_approved', 'is_featured', 'review_text', 'review_title', 'updated_at'])
        // Updated timestamp must be server-side
        && request.resource.data.updated_at == request.time;
      
      // ADMIN DELETE: Admins can delete any testimonial
      allow delete: if isAdmin();
    }
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // BOOKINGS COLLECTION (Customer Bookings)
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    match /bookings/{bookingId} {
      
      // PUBLIC CREATE: Anyone can submit a booking (no auth required)
      allow create: if 
        request.auth == null
        
        // Validation: Customer name required
        && request.resource.data.customer_name is string
        && request.resource.data.customer_name.size() >= 2
        
        // Validation: Phone required and valid
        && request.resource.data.phone is string
        && isValidPhone(request.resource.data.phone)
        
        // Validation: Email optional, valid if provided
        && (!('email' in request.resource.data)
            || request.resource.data.email == null
            || isValidEmail(request.resource.data.email))
        
        // Validation: Tour date required, must be timestamp
        && request.resource.data.tour_date is timestamp
        
        // Validation: Tour type required, must be valid option
        && request.resource.data.tour_type in ['full_day', 'morning', 'afternoon']
        
        // Validation: Number of people must be 1-4
        && request.resource.data.number_of_people is int
        && request.resource.data.number_of_people >= 1
        && request.resource.data.number_of_people <= 4
        
        // Security: Status must start as pending
        && request.resource.data.status == 'pending'
        
        // Security: Created timestamp must be server-side
        && request.resource.data.created_at == request.time;
      
      // ADMIN: Full access to read, update, delete bookings
      allow read, update, delete: if isAdmin();
    }
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // SETTINGS COLLECTION (Site Settings)
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    match /settings/{settingId} {
      
      // PUBLIC READ: Anyone can read settings (needed for contact info display)
      allow read: if true;
      
      // ADMIN UPDATE: Only admins can update settings
      allow update: if isAdmin()
        && request.resource.data.updated_at == request.time;
      
      // SUPER ADMIN: Only super admin can create/delete settings
      allow create, delete: if isSuperAdmin();
    }
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // PLACES COLLECTION (25 Sacred Places)
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    match /places/{placeId} {
      
      // PUBLIC READ: Anyone can read active places
      allow read: if resource.data.is_active == true;
      
      // ADMIN: Full access to manage places
      allow read, create, update, delete: if isAdmin();
    }
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // DEFAULT DENY ALL (Security First)
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    // Deny access to any other collections not explicitly allowed
    match /{document=**} {
      allow read, write: if false;
    }
  }
}
```

SECURITY FEATURES EXPLAINED:

1. **Public Review Submission**:
   - âœ… Anyone can submit (no auth required)
   - âœ… Must start as unapproved (is_approved: false)
   - âœ… Strict validation (name, rating, review text)
   - âœ… Server timestamp enforced (prevents manipulation)

2. **Admin Protection**:
   - âœ… Only users with custom claim `admin: true` can access
   - âœ… Custom claims set via Admin SDK (cannot be faked)
   - âœ… Admins can read all reviews (approved + pending)
   - âœ… Admins can approve/reject/delete

3. **Data Validation**:
   - âœ… Email format validation (regex)
   - âœ… Phone format validation (10-15 digits)
   - âœ… String length limits enforced
   - âœ… Rating must be 1-5 integer
   - âœ… Review text min 50 chars (prevents spam)

4. **Timestamp Security**:
   - âœ… Created/updated timestamps must be server-side
   - âœ… Prevents client manipulation of dates

5. **Rate Limiting** (Add via Firebase Extensions):
   - Install "Rate Limit Firestore" extension
   - Limit public creates to 3 per hour per IP

Click "Publish" to activate rules.

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[Continuing in next message due to length...]

Would you like me to continue with:
1. Complete Firebase config files
2. Authentication flow implementation
3. Admin panel code
4. Review submission code
5. Confirmation checklist?# ðŸ”¥ **COMPLETE FIREBASE BACKEND IMPLEMENTATION - PART 2 (FOR REPLIT AI)**

Copy this **COMPLETE CONTINUATION** and add it to your Replit AI prompt:

---

```text
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âš™ï¸ STEP 5: FIREBASE CONFIGURATION FILES (COMPLETE CODE)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

FILE 1: client/src/firebase/config.js (Frontend Firebase SDK)

```javascript
// client/src/firebase/config.js
import { initializeApp } from 'firebase/app';
import { getAuth, connectAuthEmulator } from 'firebase/auth';
import { getFirestore, connectFirestoreEmulator } from 'firebase/firestore';
import { getStorage, connectStorageEmulator } from 'firebase/storage';

// Firebase configuration from environment variables
const firebaseConfig = {
  apiKey: import.meta.env.VITE_FIREBASE_API_KEY,
  authDomain: import.meta.env.VITE_FIREBASE_AUTH_DOMAIN,
  projectId: import.meta.env.VITE_FIREBASE_PROJECT_ID,
  storageBucket: import.meta.env.VITE_FIREBASE_STORAGE_BUCKET,
  messagingSenderId: import.meta.env.VITE_FIREBASE_MESSAGING_SENDER_ID,
  appId: import.meta.env.VITE_FIREBASE_APP_ID,
  measurementId: import.meta.env.VITE_FIREBASE_MEASUREMENT_ID
};

// Validate configuration
if (!firebaseConfig.apiKey || !firebaseConfig.projectId) {
  throw new Error(
    'âŒ Firebase configuration missing! Check Replit Secrets (VITE_FIREBASE_* variables)'
  );
}

// Initialize Firebase
let app;
try {
  app = initializeApp(firebaseConfig);
  console.log('âœ… Firebase initialized successfully');
} catch (error) {
  console.error('âŒ Firebase initialization failed:', error);
  throw error;
}

// Initialize Firebase services
export const auth = getAuth(app);
export const db = getFirestore(app);
export const storage = getStorage(app);

// Development mode: Connect to emulators (optional)
if (import.meta.env.DEV && import.meta.env.VITE_USE_FIREBASE_EMULATOR === 'true') {
  console.log('ðŸ”§ Using Firebase Emulators (Development Mode)');
  connectAuthEmulator(auth, 'http://localhost:9099');
  connectFirestoreEmulator(db, 'localhost', 8080);
  connectStorageEmulator(storage, 'localhost', 9199);
}

// Export the app instance
export default app;
```

FILE 2: server/config/firebaseAdmin.js (Backend Admin SDK)

```javascript
// server/config/firebaseAdmin.js
const admin = require('firebase-admin');

// Check if already initialized (prevents re-initialization error)
if (!admin.apps.length) {
  try {
    // Initialize with environment variables
    admin.initializeApp({
      credential: admin.credential.cert({
        projectId: process.env.FIREBASE_ADMIN_PROJECT_ID,
        clientEmail: process.env.FIREBASE_ADMIN_CLIENT_EMAIL,
        // Replace \n with actual newlines in private key
        privateKey: process.env.FIREBASE_ADMIN_PRIVATE_KEY
          ? process.env.FIREBASE_ADMIN_PRIVATE_KEY.replace(/\\n/g, '\n')
          : undefined
      }),
      storageBucket: `${process.env.FIREBASE_ADMIN_PROJECT_ID}.appspot.com`
    });
    
    console.log('âœ… Firebase Admin SDK initialized successfully');
  } catch (error) {
    console.error('âŒ Firebase Admin SDK initialization failed:', error.message);
    console.error('ðŸ’¡ Check your Replit Secrets: FIREBASE_ADMIN_* variables');
    process.exit(1);
  }
}

// Export Firebase Admin services
const adminDb = admin.firestore();
const adminAuth = admin.auth();
const adminStorage = admin.storage();

module.exports = {
  admin,
  adminDb,
  adminAuth,
  adminStorage
};
```

FILE 3: .env.example (Template for Environment Variables)

```bash
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# FIREBASE CLIENT CONFIG (Frontend - Public, Safe to Expose)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

VITE_FIREBASE_API_KEY=AIzaSyXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
VITE_FIREBASE_AUTH_DOMAIN=your-project.firebaseapp.com
VITE_FIREBASE_PROJECT_ID=your-project-id
VITE_FIREBASE_STORAGE_BUCKET=your-project.appspot.com
VITE_FIREBASE_MESSAGING_SENDER_ID=123456789012
VITE_FIREBASE_APP_ID=1:123456789012:web:abcdef123456
VITE_FIREBASE_MEASUREMENT_ID=G-XXXXXXXXXX

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# FIREBASE ADMIN SDK (Backend - KEEP SECRET, NEVER EXPOSE)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

FIREBASE_ADMIN_PROJECT_ID=your-project-id
FIREBASE_ADMIN_CLIENT_EMAIL=firebase-adminsdk-xxxxx@your-project.iam.gserviceaccount.com
FIREBASE_ADMIN_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\nMIIEvQIBADANBgkqhki...\n-----END PRIVATE KEY-----\n"

# âš ï¸ Note: Copy private_key from serviceAccountKey.json
# âš ï¸ Keep the \n characters (they represent newlines)

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# CONTACT INFORMATION (Business Details)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

CONTACT_PHONE=+91 79913 01043
CONTACT_EMAIL=anshumanjha3333@gmail.com
CONTACT_INSTAGRAM=@baba_banarasi10
CONTACT_WHATSAPP=+91 79913 01043

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# DEVELOPMENT OPTIONS (Optional)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

VITE_USE_FIREBASE_EMULATOR=false
NODE_ENV=development
PORT=3000
```

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ðŸ” STEP 6: AUTHENTICATION FLOW IMPLEMENTATION
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

FILE 4: client/src/context/AuthContext.jsx (Authentication Context)

```javascript
// client/src/context/AuthContext.jsx
import { createContext, useContext, useState, useEffect } from 'react';
import { 
  signInWithEmailAndPassword, 
  signOut, 
  onAuthStateChanged,
  setPersistence,
  browserLocalPersistence,
  browserSessionPersistence
} from 'firebase/auth';
import { auth } from '../firebase/config';
import toast from 'react-hot-toast';

// Create Auth Context
const AuthContext = createContext({
  currentUser: null,
  isAdmin: false,
  adminRole: null,
  loading: true,
  login: async () => {},
  logout: async () => {}
});

// Custom hook to use auth context
export const useAuth = () => {
  const context = useContext(AuthContext);
  if (!context) {
    throw new Error('useAuth must be used within AuthProvider');
  }
  return context;
};

// Auth Provider Component
export function AuthProvider({ children }) {
  const [currentUser, setCurrentUser] = useState(null);
  const [isAdmin, setIsAdmin] = useState(false);
  const [adminRole, setAdminRole] = useState(null);
  const [loading, setLoading] = useState(true);

  // Login function
  const login = async (email, password, rememberMe = false) => {
    try {
      // Set persistence based on "Remember Me" checkbox
      await setPersistence(
        auth, 
        rememberMe ? browserLocalPersistence : browserSessionPersistence
      );
      
      // Sign in with email and password
      const userCredential = await signInWithEmailAndPassword(auth, email, password);
      
      // Force token refresh to get latest custom claims
      await userCredential.user.getIdToken(true);
      
      // Get ID token result with custom claims
      const tokenResult = await userCredential.user.getIdTokenResult();
      
      // Verify admin claim exists
      if (!tokenResult.claims.admin) {
        // User is not an admin - sign them out immediately
        await signOut(auth);
        throw new Error('UNAUTHORIZED_ACCESS');
      }
      
      // Success - user is admin
      console.log('âœ… Admin login successful:', {
        email: userCredential.user.email,
        role: tokenResult.claims.role,
        admin: tokenResult.claims.admin
      });
      
      return userCredential;
      
    } catch (error) {
      console.error('âŒ Login error:', error);
      
      // Handle specific error cases
      if (error.message === 'UNAUTHORIZED_ACCESS') {
        throw new Error('Access denied: Admin privileges required');
      }
      
      switch (error.code) {
        case 'auth/invalid-credential':
        case 'auth/wrong-password':
        case 'auth/user-not-found':
          throw new Error('Invalid email or password');
        
        case 'auth/too-many-requests':
          throw new Error('Too many failed login attempts. Please try again later.');
        
        case 'auth/network-request-failed':
          throw new Error('Network error. Check your internet connection.');
        
        case 'auth/user-disabled':
          throw new Error('This account has been disabled. Contact support.');
        
        default:
          throw new Error(error.message || 'Login failed. Please try again.');
      }
    }
  };

  // Logout function
  const logout = async () => {
    try {
      await signOut(auth);
      toast.success('Logged out successfully');
      console.log('âœ… User logged out');
    } catch (error) {
      console.error('âŒ Logout error:', error);
      toast.error('Logout failed');
      throw error;
    }
  };

  // Listen to auth state changes
  useEffect(() => {
    const unsubscribe = onAuthStateChanged(auth, async (user) => {
      if (user) {
        try {
          // Get fresh ID token with custom claims
          const tokenResult = await user.getIdTokenResult();
          
          // Check if user is admin
          const userIsAdmin = tokenResult.claims.admin === true;
          const userRole = tokenResult.claims.role || null;
          
          if (userIsAdmin) {
            setCurrentUser(user);
            setIsAdmin(true);
            setAdminRole(userRole);
            
            console.log('âœ… Admin session active:', {
              email: user.email,
              role: userRole
            });
          } else {
            // Not an admin - sign them out
            console.warn('âš ï¸ Non-admin user detected, logging out');
            await signOut(auth);
            setCurrentUser(null);
            setIsAdmin(false);
            setAdminRole(null);
          }
        } catch (error) {
          console.error('âŒ Error checking admin status:', error);
          setCurrentUser(null);
          setIsAdmin(false);
          setAdminRole(null);
        }
      } else {
        // No user signed in
        setCurrentUser(null);
        setIsAdmin(false);
        setAdminRole(null);
      }
      
      setLoading(false);
    });

    // Cleanup subscription on unmount
    return () => unsubscribe();
  }, []);

  // Auto-logout after 2 hours of inactivity
  useEffect(() => {
    if (!currentUser) return;

    let inactivityTimer;
    const INACTIVITY_TIMEOUT = 2 * 60 * 60 * 1000; // 2 hours in milliseconds

    const resetTimer = () => {
      clearTimeout(inactivityTimer);
      inactivityTimer = setTimeout(async () => {
        console.warn('â±ï¸ Session timeout due to inactivity');
        toast.error('Session expired due to inactivity');
        await logout();
      }, INACTIVITY_TIMEOUT);
    };

    // Reset timer on user activity
    const events = ['mousedown', 'keydown', 'scroll', 'touchstart'];
    events.forEach(event => {
      document.addEventListener(event, resetTimer);
    });

    resetTimer(); // Start timer

    // Cleanup
    return () => {
      clearTimeout(inactivityTimer);
      events.forEach(event => {
        document.removeEventListener(event, resetTimer);
      });
    };
  }, [currentUser]);

  // Context value
  const value = {
    currentUser,
    isAdmin,
    adminRole,
    loading,
    login,
    logout
  };

  return (
    <AuthContext.Provider value={value}>
      {!loading && children}
    </AuthContext.Provider>
  );
}
```

FILE 5: client/src/components/admin/ProtectedRoute.jsx

```javascript
// client/src/components/admin/ProtectedRoute.jsx
import { Navigate, useLocation } from 'react-router-dom';
import { useAuth } from '../../context/AuthContext';

export default function ProtectedRoute({ children, requiredRole = null }) {
  const { currentUser, isAdmin, adminRole, loading } = useAuth();
  const location = useLocation();

  // Show loading state while checking authentication
  if (loading) {
    return (
      <div className="min-h-screen flex items-center justify-center bg-gray-100">
        <div className="text-center">
          <div className="animate-spin rounded-full h-16 w-16 border-b-2 border-orange-500 mx-auto mb-4"></div>
          <p className="text-gray-600">Verifying authentication...</p>
        </div>
      </div>
    );
  }

  // Not logged in - redirect to login
  if (!currentUser) {
    console.warn('ðŸš« Access denied: User not authenticated');
    return <Navigate to="/admin/login" state={{ from: location }} replace />;
  }

  // Logged in but not admin - redirect to login with error
  if (!isAdmin) {
    console.warn('ðŸš« Access denied: User is not an admin');
    return <Navigate to="/admin/login" state={{ error: 'Admin privileges required' }} replace />;
  }

  // Check specific role requirement (optional)
  if (requiredRole && adminRole !== requiredRole) {
    console.warn(`ðŸš« Access denied: Required role "${requiredRole}", user has "${adminRole}"`);
    return (
      <Navigate 
        to="/admin/dashboard" 
        state={{ error: `This page requires ${requiredRole} privileges` }} 
        replace 
      />
    );
  }

  // All checks passed - render protected content
  return children;
}
```

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ðŸ‘‘ STEP 7: ADMIN PANEL CODE (COMPLETE IMPLEMENTATION)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

FILE 6: client/src/pages/admin/Login.jsx (Admin Login Page)

```javascript
// client/src/pages/admin/Login.jsx
import { useState, useEffect } from 'react';
import { useNavigate, useLocation } from 'react-router-dom';
import { useAuth } from '../../context/AuthContext';
import toast from 'react-hot-toast';
import { Eye, EyeOff, Lock, Mail } from 'lucide-react';

export default function AdminLogin() {
  const [email, setEmail] = useState('');
  const [password, setPassword] = useState('');
  const [rememberMe, setRememberMe] = useState(false);
  const [showPassword, setShowPassword] = useState(false);
  const [loading, setLoading] = useState(false);
  
  const { login, currentUser, isAdmin } = useAuth();
  const navigate = useNavigate();
  const location = useLocation();

  // Redirect if already logged in as admin
  useEffect(() => {
    if (currentUser && isAdmin) {
      const from = location.state?.from?.pathname || '/admin/dashboard';
      navigate(from, { replace: true });
    }
  }, [currentUser, isAdmin, navigate, location]);

  // Show error from redirect (if any)
  useEffect(() => {
    if (location.state?.error) {
      toast.error(location.state.error);
      // Clear the error from state
      window.history.replaceState({}, document.title);
    }
  }, [location]);

  // Handle form submission
  const handleSubmit = async (e) => {
    e.preventDefault();
    
    // Validation
    if (!email || !password) {
      toast.error('Please enter both email and password');
      return;
    }

    setLoading(true);

    try {
      await login(email, password, rememberMe);
      
      toast.success('Login successful! Welcome back.', {
        icon: 'ðŸ‘‹',
        duration: 3000
      });
      
      // Redirect to dashboard or previous page
      const from = location.state?.from?.pathname || '/admin/dashboard';
      navigate(from, { replace: true });
      
    } catch (error) {
      console.error('Login error:', error);
      toast.error(error.message, {
        duration: 5000
      });
    } finally {
      setLoading(false);
    }
  };

  return (
    <div className="min-h-screen flex items-center justify-center bg-gradient-to-br from-orange-50 to-gray-100 py-12 px-4 sm:px-6 lg:px-8">
      <div className="max-w-md w-full space-y-8">
        {/* Header */}
        <div className="text-center">
          <div className="mx-auto h-16 w-16 bg-orange-500 rounded-full flex items-center justify-center mb-4">
            <Lock className="h-8 w-8 text-white" />
          </div>
          <h1 className="text-4xl font-bold text-gray-900 mb-2">
            Admin Login
          </h1>
          <p className="text-gray-600">
            Baba Banarasi - Dashboard Access
          </p>
        </div>

        {/* Login Form */}
        <div className="mt-8 bg-white rounded-xl shadow-2xl p-8">
          <form onSubmit={handleSubmit} className="space-y-6">
            {/* Email Field */}
            <div>
              <label 
                htmlFor="email" 
                className="block text-sm font-medium text-gray-700 mb-2"
              >
                Email Address
              </label>
              <div className="relative">
                <div className="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                  <Mail className="h-5 w-5 text-gray-400" />
                </div>
                <input
                  id="email"
                  name="email"
                  type="email"
                  autoComplete="email"
                  required
                  value={email}
                  onChange={(e) => setEmail(e.target.value)}
                  className="appearance-none block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent transition"
                  placeholder="admin@bababanarasi.com"
                  disabled={loading}
                />
              </div>
            </div>

            {/* Password Field */}
            <div>
              <label 
                htmlFor="password" 
                className="block text-sm font-medium text-gray-700 mb-2"
              >
                Password
              </label>
              <div className="relative">
                <div className="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                  <Lock className="h-5 w-5 text-gray-400" />
                </div>
                <input
                  id="password"
                  name="password"
                  type={showPassword ? 'text' : 'password'}
                  autoComplete="current-password"
                  required
                  value={password}
                  onChange={(e) => setPassword(e.target.value)}
                  className="appearance-none block w-full pl-10 pr-10 py-3 border border-gray-300 rounded-lg placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent transition"
                  placeholder="Enter your password"
                  disabled={loading}
                />
                <button
                  type="button"
                  onClick={() => setShowPassword(!showPassword)}
                  className="absolute inset-y-0 right-0 pr-3 flex items-center"
                  disabled={loading}
                >
                  {showPassword ? (
                    <EyeOff className="h-5 w-5 text-gray-400 hover:text-gray-600" />
                  ) : (
                    <Eye className="h-5 w-5 text-gray-400 hover:text-gray-600" />
                  )}
                </button>
              </div>
            </div>

            {/* Remember Me Checkbox */}
            <div className="flex items-center justify-between">
              <div className="flex items-center">
                <input
                  id="remember-me"
                  name="remember-me"
                  type="checkbox"
                  checked={rememberMe}
                  onChange={(e) => setRememberMe(e.target.checked)}
                  className="h-4 w-4 text-orange-500 focus:ring-orange-500 border-gray-300 rounded cursor-pointer"
                  disabled={loading}
                />
                <label 
                  htmlFor="remember-me" 
                  className="ml-2 block text-sm text-gray-700 cursor-pointer"
                >
                  Remember me (30 days)
                </label>
              </div>
            </div>

            {/* Submit Button */}
            <button
              type="submit"
              disabled={loading}
              className="w-full flex justify-center items-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-base font-semibold text-white bg-orange-500 hover:bg-orange-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200"
            >
              {loading ? (
                <>
                  <svg className="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg " fill="none" viewBox="0 0 24 24">
                    <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle>
                    <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                  </svg>
                  Logging in...
                </>
              ) : (
                'Login to Dashboard'
              )}
            </button>
          </form>

          {/* Help Text */}
          <div className="mt-6 text-center">
            <p className="text-sm text-gray-600">
              Need access? Contact:{' '}
              <a 
                href="mailto:anshumanjha3333@gmail.com" 
                className="text-orange-500 hover:text-orange-600 font-medium"
              >
                anshumanjha3333@gmail.com
              </a>
            </p>
          </div>
        </div>

        {/* Security Notice */}
        <div className="text-center">
          <p className="text-xs text-gray-500">
            ðŸ”’ This is a secure admin area. All login attempts are monitored and logged.
          </p>
        </div>
      </div>
    </div>
  );
}
```

FILE 7: client/src/pages/admin/ManageReviews.jsx (Review Management)

```javascript
// client/src/pages/admin/ManageReviews.jsx
import { useState, useEffect } from 'react';
import { 
  collection, 
  query, 
  orderBy, 
  getDocs, 
  updateDoc, 
  deleteDoc, 
  doc,
  where,
  serverTimestamp
} from 'firebase/firestore';
import { db } from '../../firebase/config';
import toast from 'react-hot-toast';
import { Star, Check, X, Trash2, Eye, Filter } from 'lucide-react';

export default function ManageReviews() {
  const [reviews, setReviews] = useState([]);
  const [filter, setFilter] = useState('all'); // all, pending, approved, featured
  const [loading, setLoading] = useState(true);
  const [searchTerm, setSearchTerm] = useState('');

  // Fetch reviews from Firestore
  const fetchReviews = async () => {
    setLoading(true);
    try {
      let q = query(
        collection(db, 'testimonials'),
        orderBy('created_at', 'desc')
      );

      // Apply filter
      if (filter === 'pending') {
        q = query(
          collection(db, 'testimonials'),
          where('is_approved', '==', false),
          orderBy('created_at', 'desc')
        );
      } else if (filter === 'approved') {
        q = query(
          collection(db, 'testimonials'),
          where('is_approved', '==', true),
          orderBy('created_at', 'desc')
        );
      } else if (filter === 'featured') {
        q = query(
          collection(db, 'testimonials'),
          where('is_featured', '==', true),
          orderBy('created_at', 'desc')
        );
      }

      const querySnapshot = await getDocs(q);
      const reviewsData = querySnapshot.docs.map(doc => ({
        id: doc.id,
        ...doc.data(),
        created_at: doc.data().created_at?.toDate() // Convert Firestore Timestamp to Date
      }));

      setReviews(reviewsData);
      console.log(`âœ… Fetched ${reviewsData.length} reviews (filter: ${filter})`);
    } catch (error) {
      console.error('âŒ Error fetching reviews:', error);
      toast.error('Failed to load reviews: ' + error.message);
    } finally {
      setLoading(false);
    }
  };

  useEffect(() => {
    fetchReviews();
  }, [filter]);

  // Approve review
  const handleApprove = async (reviewId, customerName) => {
    try {
      await updateDoc(doc(db, 'testimonials', reviewId), {
        is_approved: true,
        updated_at: serverTimestamp()
      });
      
      toast.success(`âœ… Review by ${customerName} approved!`);
      fetchReviews(); // Refresh list
    } catch (error) {
      console.error('âŒ Error approving review:', error);
      toast.error('Failed to approve review');
    }
  };

  // Reject (delete) review
  const handleDelete = async (reviewId, customerName) => {
    if (!confirm(`Delete review by ${customerName}? This cannot be undone.`)) {
      return;
    }

    try {
      await deleteDoc(doc(db, 'testimonials', reviewId));
      toast.success(`ðŸ—‘ï¸ Review by ${customerName} deleted`);
      fetchReviews();
    } catch (error) {
      console.error('âŒ Error deleting review:', error);
      toast.error('Failed to delete review');
    }
  };

  // Toggle featured status
  const handleToggleFeatured = async (reviewId, currentStatus, customerName) => {
    try {
      await updateDoc(doc(db, 'testimonials', reviewId), {
        is_featured: !currentStatus,
        updated_at: serverTimestamp()
      });
      
      const action = !currentStatus ? 'marked as featured' : 'removed from featured';
      toast.success(`â­ Review by ${customerName} ${action}`);
      fetchReviews();
    } catch (error) {
      console.error('âŒ Error updating featured status:', error);
      toast.error('Failed to update featured status');
    }
  };

  // Filter reviews by search term
  const filteredReviews = reviews.filter(review => 
    review.customer_name.toLowerCase().includes(searchTerm.toLowerCase()) ||
    review.review_text.toLowerCase().includes(searchTerm.toLowerCase()) ||
    review.customer_email?.toLowerCase().includes(searchTerm.toLowerCase())
  );

  // Stats
  const stats = {
    total: reviews.length,
    pending: reviews.filter(r => !r.is_approved).length,
    approved: reviews.filter(r => r.is_approved).length,
    featured: reviews.filter(r => r.is_featured).length
  };

  return (
    <div className="p-6 max-w-7xl mx-auto">
      {/* Header */}
      <div className="mb-8">
        <h1 className="text-3xl font-bold text-gray-900 mb-2">Manage Reviews</h1>
        <p className="text-gray-600">Approve, feature, or delete customer testimonials</p>
      </div>

      {/* Stats Cards */}
      <div className="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
        <div className="bg-white rounded-lg shadow p-4">
          <div className="text-2xl font-bold text-gray-900">{stats.total}</div>
          <div className="text-sm text-gray-600">Total Reviews</div>
        </div>
        <div className="bg-yellow-50 rounded-lg shadow p-4">
          <div className="text-2xl font-bold text-yellow-600">{stats.pending}</div>
          <div className="text-sm text-gray-600">Pending Approval</div>
        </div>
        <div className="bg-green-50 rounded-lg shadow p-4">
          <div className="text-2xl font-bold text-green-600">{stats.approved}</div>
          <div className="text-sm text-gray-600">Approved</div>
        </div>
        <div className="bg-purple-50 rounded-lg shadow p-4">
          <div className="text-2xl font-bold text-purple-600">{stats.featured}</div>
          <div className="text-sm text-gray-600">Featured</div>
        </div>
      </div>

      {/* Filters & Search */}
      <div className="bg-white rounded-lg shadow p-4 mb-6">
        <div className="flex flex-col md:flex-row gap-4 justify-between items-center">
          {/* Filter Tabs */}
          <div className="flex gap-2 flex-wrap">
            <button
              onClick={() => setFilter('all')}
              className={`px-4 py-2 rounded-lg font-medium transition ${
                filter === 'all' 
                  ? 'bg-orange-500 text-white' 
                  : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
              }`}
            >
              All ({stats.total})
            </button>
            <button
              onClick={() => setFilter('pending')}
              className={`px-4 py-2 rounded-lg font-medium transition ${
                filter === 'pending' 
                  ? 'bg-yellow-500 text-white' 
                  : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
              }`}
            >
              Pending ({stats.pending})
            </button>
            <button
              onClick={() => setFilter('approved')}
              className={`px-4 py-2 rounded-lg font-medium transition ${
                filter === 'approved' 
                  ? 'bg-green-500 text-white' 
                  : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
              }`}
            >
              Approved ({stats.approved})
            </button>
            <button
              onClick={() => setFilter('featured')}
              className={`px-4 py-2 rounded-lg font-medium transition ${
                filter === 'featured' 
                  ? 'bg-purple-500 text-white' 
                  : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
              }`}
            >
              Featured ({stats.featured})
            </button>
          </div>

          {/* Search */}
          <div className="w-full md:w-64">
            <input
              type="text"
              placeholder="Search reviews..."
              value={searchTerm}
              onChange={(e) => setSearchTerm(e.target.value)}
              className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
            />
          </div>
        </div>
      </div>

      {/* Reviews Table */}
      {loading ? (
        <div className="text-center py-12">
          <div className="animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500 mx-auto"></div>
          <p className="mt-4 text-gray-600">Loading reviews...</p>
        </div>
      ) : filteredReviews.length === 0 ? (
        <div className="bg-white rounded-lg shadow p-12 text-center">
          <p className="text-gray-500 text-lg">No reviews found</p>
        </div>
      ) : (
        <div className="bg-white rounded-lg shadow overflow-hidden">
          <div className="overflow-x-auto">
            <table className="w-full">
              <thead className="bg-gray-50 border-b border-gray-200">
                <tr>
                  <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                    Customer
                  </th>
                  <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                    Rating
                  </th>
                  <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                    Review
                  </th>
                  <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                    Status
                  </th>
                  <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                    Date
                  </th>
                  <th className="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
                    Actions
                  </th>
                </tr>
              </thead>
              <tbody className="bg-white divide-y divide-gray-200">
                {filteredReviews.map((review) => (
                  <tr key={review.id} className="hover:bg-gray-50">
                    <td className="px-6 py-4 whitespace-nowrap">
                      <div className="flex items-center">
                        <div className="flex-shrink-0 h-10 w-10">
                          {review.customer_avatar ? (
                            <img 
                              className="h-10 w-10 rounded-full" 
                              src={review.customer_avatar} 
                              alt={review.customer_name} 
                            />
                          ) : (
                            <div className="h-10 w-10 rounded-full bg-orange-100 flex items-center justify-center">
                              <span className="text-orange-600 font-semibold text-sm">
                                {review.customer_name.charAt(0).toUpperCase()}
                              </span>
                            </div>
                          )}
                        </div>
                        <div className="ml-4">
                          <div className="text-sm font-medium text-gray-900">
                            {review.customer_name}
                          </div>
                          <div className="text-sm text-gray-500">
                            {review.customer_email || 'No email'}
                          </div>
                        </div>
                      </div>
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap">
                      <div className="flex items-center">
                        {[...Array(5)].map((_, i) => (
                          <Star
                            key={i}
                            className={`h-4 w-4 ${
                              i < review.rating 
                                ? 'text-yellow-400 fill-yellow-400' 
                                : 'text-gray-300'
                            }`}
                          />
                        ))}
                        <span className="ml-2 text-sm text-gray-600">
                          {review.rating}/5
                        </span>
                      </div>
                    </td>
                    <td className="px-6 py-4">
                      <div className="max-w-xs">
                        {review.review_title && (
                          <div className="text-sm font-semibold text-gray-900 mb-1">
                            {review.review_title}
                          </div>
                        )}
                        <div className="text-sm text-gray-600 line-clamp-2">
                          {review.review_text}
                        </div>
                      </div>
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap">
                      <div className="flex flex-col gap-1">
                        <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${
                          review.is_approved 
                            ? 'bg-green-100 text-green-800' 
                            : 'bg-yellow-100 text-yellow-800'
                        }`}>
                          {review.is_approved ? 'âœ“ Approved' : 'â³ Pending'}
                        </span>
                        {review.is_featured && (
                          <span className="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800">
                            â­ Featured
                          </span>
                        )}
                      </div>
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                      {review.created_at ? new Date(review.created_at).toLocaleDateString('en-IN', {
                        day: 'numeric',
                        month: 'short',
                        year: 'numeric'
                      }) : 'N/A'}
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                      <div className="flex justify-end gap-2">
                        {!review.is_approved && (
                          <button
                            onClick={() => handleApprove(review.id, review.customer_name)}
                            className="inline-flex items-center px-3 py-1.5 bg-green-500 text-white rounded-lg hover:bg-green-600 transition"
                            title="Approve Review"
                          >
                            <Check className="h-4 w-4" />
                          </button>
                        )}
                        <button
                          onClick={() => handleToggleFeatured(review.id, review.is_featured, review.customer_name)}
                          className={`inline-flex items-center px-3 py-1.5 rounded-lg transition ${
                            review.is_featured
                              ? 'bg-purple-100 text-purple-600 hover:bg-purple-200'
                              : 'bg-gray-100 text-gray-600 hover:bg-gray-200'
                          }`}
                          title={review.is_featured ? 'Remove from Featured' : 'Mark as Featured'}
                        >
                          <Star className={`h-4 w-4 ${review.is_featured ? 'fill-current' : ''}`} />
                        </button>
                        <button
                          onClick={() => handleDelete(review.id, review.customer_name)}
                          className="inline-flex items-center px-3 py-1.5 bg-red-500 text-white rounded-lg hover:bg-red-600 transition"
                          title="Delete Review"
                        >
                          <Trash2 className="h-4 w-4" />
                        </button>
                      </div>
                    </td>
                  </tr>
                ))}
              </tbody>
            </table>
          </div>
        </div>
      )}
    </div>
  );
}
```

[Continuing with Review Submission Code and Final Checklist in next message...]

Would you like me to continue with:
1. âœ… Public Review Submission Form (complete code)
2. âœ… App.jsx routing setup
3. âœ… Final confirmation checklist
4. âœ… Common errors & solutions
5. âœ… Testing instructions?# ðŸ”¥ **FIREBASE BACKEND IMPLEMENTATION - PART 3 (FINAL)**

Continue adding this to your Replit AI prompt:

---

```text
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ðŸ“ STEP 8: PUBLIC REVIEW SUBMISSION FORM (COMPLETE CODE)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

FILE 8: client/src/components/forms/ReviewSubmitForm.jsx

```javascript
// client/src/components/forms/ReviewSubmitForm.jsx
import { useState } from 'react';
import { collection, addDoc, serverTimestamp } from 'firebase/firestore';
import { ref, uploadBytes, getDownloadURL } from 'firebase/storage';
import { db, storage } from '../../firebase/config';
import toast from 'react-hot-toast';
import Confetti from 'react-confetti';
import { useDropzone } from 'react-dropzone';
import ReactStars from 'react-rating-stars-component';
import { X, Upload, Star, Loader } from 'lucide-react';

export default function ReviewSubmitForm({ onClose }) {
  const [formData, setFormData] = useState({
    customer_name: '',
    customer_email: '',
    customer_phone: '',
    rating: 0,
    review_title: '',
    review_text: '',
    tour_taken: 'Full Day Solo Scooter Darshan',
    booking_date: ''
  });

  const [photoFile, setPhotoFile] = useState(null);
  const [photoPreview, setPhotoPreview] = useState(null);
  const [showConfetti, setShowConfetti] = useState(false);
  const [loading, setLoading] = useState(false);
  const [errors, setErrors] = useState({});

  // Photo upload with drag & drop
  const { getRootProps, getInputProps, isDragActive } = useDropzone({
    accept: {
      'image/*': ['.jpeg', '.jpg', '.png', '.webp']
    },
    maxSize: 2097152, // 2MB
    maxFiles: 1,
    onDrop: (acceptedFiles, rejectedFiles) => {
      if (rejectedFiles.length > 0) {
        const error = rejectedFiles[0].errors[0];
        if (error.code === 'file-too-large') {
          toast.error('Image must be less than 2MB');
        } else {
          toast.error('Invalid file type. Use JPG, PNG, or WebP');
        }
        return;
      }

      if (acceptedFiles.length > 0) {
        const file = acceptedFiles[0];
        setPhotoFile(file);
        setPhotoPreview(URL.createObjectURL(file));
        toast.success('Photo uploaded!');
      }
    }
  });

  // Remove uploaded photo
  const removePhoto = () => {
    setPhotoFile(null);
    setPhotoPreview(null);
    if (photoPreview) {
      URL.revokeObjectURL(photoPreview);
    }
  };

  // Handle input changes
  const handleChange = (e) => {
    const { name, value } = e.target;
    setFormData(prev => ({ ...prev, [name]: value }));
    // Clear error for this field
    if (errors[name]) {
      setErrors(prev => ({ ...prev, [name]: null }));
    }
  };

  // Handle rating change
  const handleRatingChange = (newRating) => {
    setFormData(prev => ({ ...prev, rating: newRating }));
    if (errors.rating) {
      setErrors(prev => ({ ...prev, rating: null }));
    }
  };

  // Validate form
  const validateForm = () => {
    const newErrors = {};

    // Name validation
    if (!formData.customer_name.trim()) {
      newErrors.customer_name = 'Name is required';
    } else if (formData.customer_name.trim().length < 2) {
      newErrors.customer_name = 'Name must be at least 2 characters';
    }

    // Email validation (optional, but if provided must be valid)
    if (formData.customer_email && !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(formData.customer_email)) {
      newErrors.customer_email = 'Invalid email format';
    }

    // Rating validation
    if (formData.rating === 0) {
      newErrors.rating = 'Please select a rating (1-5 stars)';
    }

    // Review text validation
    if (!formData.review_text.trim()) {
      newErrors.review_text = 'Review text is required';
    } else if (formData.review_text.trim().length < 50) {
      newErrors.review_text = `Review must be at least 50 characters (${formData.review_text.trim().length}/50)`;
    } else if (formData.review_text.length > 1000) {
      newErrors.review_text = 'Review must be less than 1000 characters';
    }

    // Review title validation (optional, max 100)
    if (formData.review_title && formData.review_title.length > 100) {
      newErrors.review_title = 'Title must be less than 100 characters';
    }

    setErrors(newErrors);
    return Object.keys(newErrors).length === 0;
  };

  // Upload photo to Firebase Storage
  const uploadPhoto = async (file) => {
    try {
      const timestamp = Date.now();
      const filename = `review-photos/${timestamp}-${file.name.replace(/[^a-zA-Z0-9.]/g, '_')}`;
      const storageRef = ref(storage, filename);
      
      // Upload file
      const snapshot = await uploadBytes(storageRef, file);
      
      // Get download URL
      const downloadURL = await getDownloadURL(snapshot.ref);
      
      console.log('âœ… Photo uploaded:', downloadURL);
      return downloadURL;
    } catch (error) {
      console.error('âŒ Photo upload failed:', error);
      throw new Error('Failed to upload photo: ' + error.message);
    }
  };

  // Handle form submission
  const handleSubmit = async (e) => {
    e.preventDefault();

    // Validate form
    if (!validateForm()) {
      toast.error('Please fix the errors in the form');
      return;
    }

    setLoading(true);

    try {
      let photoURL = null;

      // Upload photo if provided
      if (photoFile) {
        toast.loading('Uploading photo...', { id: 'photo-upload' });
        photoURL = await uploadPhoto(photoFile);
        toast.success('Photo uploaded!', { id: 'photo-upload' });
      }

      // Submit review to Firestore
      toast.loading('Submitting review...', { id: 'review-submit' });

      const reviewData = {
        customer_name: formData.customer_name.trim(),
        customer_email: formData.customer_email.trim() || null,
        customer_phone: formData.customer_phone.trim() || null,
        customer_avatar: photoURL,
        rating: formData.rating,
        review_title: formData.review_title.trim() || null,
        review_text: formData.review_text.trim(),
        tour_taken: formData.tour_taken,
        booking_date: formData.booking_date ? new Date(formData.booking_date) : null,
        is_approved: false, // Requires admin approval
        is_featured: false,
        source: 'website',
        helpful_votes: 0,
        created_at: serverTimestamp(),
        updated_at: serverTimestamp()
      };

      await addDoc(collection(db, 'testimonials'), reviewData);

      toast.success('Review submitted successfully!', { id: 'review-submit' });
      
      // Show confetti
      setShowConfetti(true);

      // Reset form
      setFormData({
        customer_name: '',
        customer_email: '',
        customer_phone: '',
        rating: 0,
        review_title: '',
        review_text: '',
        tour_taken: 'Full Day Solo Scooter Darshan',
        booking_date: ''
      });
      setPhotoFile(null);
      setPhotoPreview(null);

      // Auto-close modal after 3 seconds
      setTimeout(() => {
        setShowConfetti(false);
        onClose();
      }, 3000);

    } catch (error) {
      console.error('âŒ Review submission failed:', error);
      toast.error('Failed to submit review: ' + error.message);
    } finally {
      setLoading(false);
    }
  };

  return (
    <>
      {/* Confetti Animation */}
      {showConfetti && (
        <Confetti
          width={window.innerWidth}
          height={window.innerHeight}
          recycle={false}
          numberOfPieces={500}
          gravity={0.3}
        />
      )}

      {/* Modal Overlay */}
      <div className="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 overflow-y-auto">
        <div className="bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto relative">
          {/* Close Button */}
          <button
            onClick={onClose}
            className="absolute top-4 right-4 p-2 rounded-full hover:bg-gray-100 transition z-10"
            disabled={loading}
          >
            <X className="h-6 w-6 text-gray-600" />
          </button>

          {/* Header */}
          <div className="px-6 py-8 border-b border-gray-200">
            <div className="text-center">
              <div className="mx-auto h-16 w-16 bg-orange-100 rounded-full flex items-center justify-center mb-4">
                <Star className="h-8 w-8 text-orange-500 fill-orange-500" />
              </div>
              <h2 className="text-3xl font-bold text-gray-900 mb-2">
                Share Your Experience
              </h2>
              <p className="text-gray-600">
                Help others discover the magic of Baba Banarasi through your story
              </p>
            </div>
          </div>

          {/* Form */}
          <form onSubmit={handleSubmit} className="px-6 py-6 space-y-6">
            
            {/* Your Details Section */}
            <div>
              <h3 className="text-lg font-semibold text-gray-900 mb-4">Your Details</h3>
              
              {/* Name */}
              <div className="mb-4">
                <label className="block text-sm font-medium text-gray-700 mb-2">
                  Full Name <span className="text-red-500">*</span>
                </label>
                <input
                  type="text"
                  name="customer_name"
                  value={formData.customer_name}
                  onChange={handleChange}
                  className={`w-full px-4 py-3 border ${errors.customer_name ? 'border-red-500' : 'border-gray-300'} rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent transition`}
                  placeholder="Your name"
                  disabled={loading}
                />
                {errors.customer_name && (
                  <p className="mt-1 text-sm text-red-500">{errors.customer_name}</p>
                )}
              </div>

              {/* Email */}
              <div className="mb-4">
                <label className="block text-sm font-medium text-gray-700 mb-2">
                  Email <span className="text-gray-400">(optional)</span>
                </label>
                <input
                  type="email"
                  name="customer_email"
                  value={formData.customer_email}
                  onChange={handleChange}
                  className={`w-full px-4 py-3 border ${errors.customer_email ? 'border-red-500' : 'border-gray-300'} rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent transition`}
                  placeholder="your@email.com"
                  disabled={loading}
                />
                {errors.customer_email && (
                  <p className="mt-1 text-sm text-red-500">{errors.customer_email}</p>
                )}
                <p className="mt-1 text-xs text-gray-500">
                  ðŸ”’ We'll never share your email publicly
                </p>
              </div>

              {/* Phone */}
              <div className="mb-4">
                <label className="block text-sm font-medium text-gray-700 mb-2">
                  Phone <span className="text-gray-400">(optional)</span>
                </label>
                <input
                  type="tel"
                  name="customer_phone"
                  value={formData.customer_phone}
                  onChange={handleChange}
                  className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent transition"
                  placeholder="+91 98765 43210"
                  disabled={loading}
                />
              </div>
            </div>

            {/* Upload Photo */}
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                Upload Your Photo <span className="text-gray-400">(optional, max 2MB)</span>
              </label>
              
              {photoPreview ? (
                <div className="relative">
                  <img 
                    src={photoPreview} 
                    alt="Preview" 
                    className="w-32 h-32 rounded-full object-cover mx-auto border-4 border-orange-200"
                  />
                  <button
                    type="button"
                    onClick={removePhoto}
                    className="absolute top-0 right-1/2 translate-x-16 bg-red-500 text-white rounded-full p-1.5 hover:bg-red-600 transition"
                    disabled={loading}
                  >
                    <X className="h-4 w-4" />
                  </button>
                </div>
              ) : (
                <div
                  {...getRootProps()}
                  className={`border-2 border-dashed ${isDragActive ? 'border-orange-500 bg-orange-50' : 'border-gray-300'} rounded-lg p-8 text-center cursor-pointer hover:border-orange-500 hover:bg-orange-50 transition`}
                >
                  <input {...getInputProps()} disabled={loading} />
                  <Upload className="h-12 w-12 text-gray-400 mx-auto mb-3" />
                  {isDragActive ? (
                    <p className="text-orange-600 font-medium">Drop your photo here</p>
                  ) : (
                    <>
                      <p className="text-gray-600 mb-1">
                        ðŸ“· Drag & drop or click to upload
                      </p>
                      <p className="text-xs text-gray-500">
                        JPG, PNG, or WebP (max 2MB)
                      </p>
                    </>
                  )}
                </div>
              )}
            </div>

            {/* Rating */}
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                Your Rating <span className="text-red-500">*</span>
              </label>
              <div className="flex justify-center">
                <ReactStars
                  count={5}
                  onChange={handleRatingChange}
                  size={50}
                  activeColor="#f97316"
                  color="#d1d5db"
                  value={formData.rating}
                  edit={!loading}
                />
              </div>
              {formData.rating > 0 && (
                <p className="text-center text-sm text-gray-600 mt-2">
                  You selected: {formData.rating} star{formData.rating !== 1 ? 's' : ''}
                </p>
              )}
              {errors.rating && (
                <p className="text-center mt-1 text-sm text-red-500">{errors.rating}</p>
              )}
            </div>

            {/* Review Title */}
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                Review Title <span className="text-gray-400">(optional, max 100 chars)</span>
              </label>
              <input
                type="text"
                name="review_title"
                value={formData.review_title}
                onChange={handleChange}
                maxLength={100}
                className={`w-full px-4 py-3 border ${errors.review_title ? 'border-red-500' : 'border-gray-300'} rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent transition`}
                placeholder="e.g., Best way to explore Varanasi!"
                disabled={loading}
              />
              <div className="mt-1 flex justify-between text-xs text-gray-500">
                <span>A catchy title helps your review stand out</span>
                <span>{formData.review_title.length}/100</span>
              </div>
              {errors.review_title && (
                <p className="mt-1 text-sm text-red-500">{errors.review_title}</p>
              )}
            </div>

            {/* Review Text */}
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                Your Review <span className="text-red-500">*</span>
              </label>
              <textarea
                name="review_text"
                value={formData.review_text}
                onChange={handleChange}
                rows={5}
                maxLength={1000}
                className={`w-full px-4 py-3 border ${errors.review_text ? 'border-red-500' : 'border-gray-300'} rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent transition resize-none`}
                placeholder="Share your experience with Baba Banarasi. What did you like? How was the guide? Would you recommend it to others? (minimum 50 characters)"
                disabled={loading}
              />
              <div className="mt-1 flex justify-between text-xs">
                <span className={formData.review_text.trim().length < 50 ? 'text-red-500' : 'text-green-600'}>
                  {formData.review_text.trim().length < 50 
                    ? `${50 - formData.review_text.trim().length} more characters needed` 
                    : 'âœ“ Minimum met'}
                </span>
                <span className="text-gray-500">{formData.review_text.length}/1000</span>
              </div>
              {errors.review_text && (
                <p className="mt-1 text-sm text-red-500">{errors.review_text}</p>
              )}
            </div>

            {/* Tour Selection */}
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                Which tour did you take? <span className="text-red-500">*</span>
              </label>
              <select
                name="tour_taken"
                value={formData.tour_taken}
                onChange={handleChange}
                className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent transition"
                disabled={loading}
              >
                <option value="Full Day Solo Scooter Darshan">Full Day Solo Scooter Darshan</option>
                <option value="Morning Session Only">Morning Session Only</option>
                <option value="Afternoon Session Only">Afternoon Session Only</option>
                <option value="Custom Tour">Custom Tour</option>
              </select>
            </div>

            {/* Travel Date */}
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                When did you travel? <span className="text-gray-400">(optional)</span>
              </label>
              <input
                type="date"
                name="booking_date"
                value={formData.booking_date}
                onChange={handleChange}
                max={new Date().toISOString().split('T')[0]}
                className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent transition"
                disabled={loading}
              />
            </div>

            {/* Trust Signals */}
            <div className="bg-blue-50 border border-blue-200 rounded-lg p-4 space-y-2 text-sm text-blue-800">
              <p>âœ… Your review will be verified before publishing</p>
              <p>ðŸ”’ Your email and phone will never be shared publicly</p>
              <p>ðŸ“ All reviews are moderated to ensure authenticity</p>
              <p>â±ï¸ Reviews typically approved within 24 hours</p>
            </div>

            {/* Buttons */}
            <div className="flex gap-4 pt-4">
              <button
                type="button"
                onClick={onClose}
                className="flex-1 px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 font-semibold transition"
                disabled={loading}
              >
                Cancel
              </button>
              <button
                type="submit"
                disabled={loading}
                className="flex-1 px-6 py-3 bg-orange-500 text-white rounded-lg hover:bg-orange-600 font-semibold transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center"
              >
                {loading ? (
                  <>
                    <Loader className="animate-spin h-5 w-5 mr-2" />
                    Submitting...
                  </>
                ) : (
                  'Submit Review'
                )}
              </button>
            </div>
          </form>
        </div>
      </div>
    </>
  );
}
```

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ðŸ”Œ STEP 9: APP ROUTING SETUP (COMPLETE INTEGRATION)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

FILE 9: client/src/App.jsx (Main App with Routing)

```javascript
// client/src/App.jsx
import { BrowserRouter, Routes, Route, Navigate } from 'react-router-dom';
import { Toaster } from 'react-hot-toast';
import { AuthProvider } from './context/AuthContext';
import ProtectedRoute from './components/admin/ProtectedRoute';

// Public Pages
import Home from './pages/Home';
import Tours from './pages/Tours';
import TourDetail from './pages/TourDetail';
import Places from './pages/Places';
import PlaceDetail from './pages/PlaceDetail';
import Reviews from './pages/Reviews';
import About from './pages/About';
import Contact from './pages/Contact';
import NotFound from './pages/NotFound';

// Admin Pages
import AdminLogin from './pages/admin/Login';
import AdminDashboard from './pages/admin/Dashboard';
import ManageBookings from './pages/admin/Bookings';
import ManageTours from './pages/admin/Tours';
import ManagePlaces from './pages/admin/Places';
import ManageReviews from './pages/admin/ManageReviews';
import EditContent from './pages/admin/Content';
import AdminSettings from './pages/admin/Settings';

function App() {
  return (
    <AuthProvider>
      <BrowserRouter>
        <Routes>
          {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
          {/* PUBLIC ROUTES (No Authentication) */}
          {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
          
          <Route path="/" element={<Home />} />
          <Route path="/tours" element={<Tours />} />
          <Route path="/tours/:slug" element={<TourDetail />} />
          <Route path="/places" element={<Places />} />
          <Route path="/places/:slug" element={<PlaceDetail />} />
          <Route path="/reviews" element={<Reviews />} />
          <Route path="/about" element={<About />} />
          <Route path="/contact" element={<Contact />} />

          {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
          {/* ADMIN ROUTES (Protected) */}
          {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
          
          {/* Admin Login (Public - but redirects if already logged in) */}
          <Route path="/admin/login" element={<AdminLogin />} />
          
          {/* Protected Admin Routes */}
          <Route
            path="/admin/dashboard"
            element={
              <ProtectedRoute>
                <AdminDashboard />
              </ProtectedRoute>
            }
          />
          
          <Route
            path="/admin/bookings"
            element={
              <ProtectedRoute>
                <ManageBookings />
              </ProtectedRoute>
            }
          />
          
          <Route
            path="/admin/tours"
            element={
              <ProtectedRoute>
                <ManageTours />
              </ProtectedRoute>
            }
          />
          
          <Route
            path="/admin/places"
            element={
              <ProtectedRoute>
                <ManagePlaces />
              </ProtectedRoute>
            }
          />
          
          <Route
            path="/admin/reviews"
            element={
              <ProtectedRoute>
                <ManageReviews />
              </ProtectedRoute>
            }
          />
          
          <Route
            path="/admin/content"
            element={
              <ProtectedRoute>
                <EditContent />
              </ProtectedRoute>
            }
          />
          
          <Route
            path="/admin/settings"
            element={
              <ProtectedRoute>
                <AdminSettings />
              </ProtectedRoute>
            }
          />

          {/* Admin root redirect */}
          <Route path="/admin" element={<Navigate to="/admin/dashboard" replace />} />

          {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
          {/* 404 NOT FOUND */}
          {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
          
          <Route path="*" element={<NotFound />} />
        </Routes>

        {/* Global Toast Notifications */}
        <Toaster
          position="top-right"
          toastOptions={{
            duration: 4000,
            style: {
              background: '#333',
              color: '#fff',
              borderRadius: '10px',
              padding: '16px',
            },
            success: {
              iconTheme: {
                primary: '#10b981',
                secondary: '#fff',
              },
            },
            error: {
              iconTheme: {
                primary: '#ef4444',
                secondary: '#fff',
              },
            },
          }}
        />
      </BrowserRouter>
    </AuthProvider>
  );
}

export default App;
```

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âœ… STEP 10: FINAL CONFIRMATION CHECKLIST
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

BEFORE DECLARING SUCCESS, VERIFY ALL OF THESE:

FRONTEND CONFIRMATION:
âœ… Website looks PIXEL-PERFECT identical to https://varanasi-scoot-darshan.lovable.app/ 
âœ… All images are the EXACT same (no replacements)
âœ… All colors, fonts, spacing match exactly
âœ… All animations work identically
âœ… Mobile responsive design intact
âœ… Navigation menu identical .  # ðŸ”¥ **FIREBASE BACKEND IMPLEMENTATION - PART 3 (FINAL)**

Continue adding this to your Replit AI prompt:

---

```text
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ðŸ“ STEP 8: PUBLIC REVIEW SUBMISSION FORM (COMPLETE CODE)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

FILE 8: client/src/components/forms/ReviewSubmitForm.jsx

```javascript
// client/src/components/forms/ReviewSubmitForm.jsx
import { useState } from 'react';
import { collection, addDoc, serverTimestamp } from 'firebase/firestore';
import { ref, uploadBytes, getDownloadURL } from 'firebase/storage';
import { db, storage } from '../../firebase/config';
import toast from 'react-hot-toast';
import Confetti from 'react-confetti';
import { useDropzone } from 'react-dropzone';
import ReactStars from 'react-rating-stars-component';
import { X, Upload, Star, Loader } from 'lucide-react';

export default function ReviewSubmitForm({ onClose }) {
  const [formData, setFormData] = useState({
    customer_name: '',
    customer_email: '',
    customer_phone: '',
    rating: 0,
    review_title: '',
    review_text: '',
    tour_taken: 'Full Day Solo Scooter Darshan',
    booking_date: ''
  });

  const [photoFile, setPhotoFile] = useState(null);
  const [photoPreview, setPhotoPreview] = useState(null);
  const [showConfetti, setShowConfetti] = useState(false);
  const [loading, setLoading] = useState(false);
  const [errors, setErrors] = useState({});

  // Photo upload with drag & drop
  const { getRootProps, getInputProps, isDragActive } = useDropzone({
    accept: {
      'image/*': ['.jpeg', '.jpg', '.png', '.webp']
    },
    maxSize: 2097152, // 2MB
    maxFiles: 1,
    onDrop: (acceptedFiles, rejectedFiles) => {
      if (rejectedFiles.length > 0) {
        const error = rejectedFiles[0].errors[0];
        if (error.code === 'file-too-large') {
          toast.error('Image must be less than 2MB');
        } else {
          toast.error('Invalid file type. Use JPG, PNG, or WebP');
        }
        return;
      }

      if (acceptedFiles.length > 0) {
        const file = acceptedFiles[0];
        setPhotoFile(file);
        setPhotoPreview(URL.createObjectURL(file));
        toast.success('Photo uploaded!');
      }
    }
  });

  // Remove uploaded photo
  const removePhoto = () => {
    setPhotoFile(null);
    setPhotoPreview(null);
    if (photoPreview) {
      URL.revokeObjectURL(photoPreview);
    }
  };

  // Handle input changes
  const handleChange = (e) => {
    const { name, value } = e.target;
    setFormData(prev => ({ ...prev, [name]: value }));
    // Clear error for this field
    if (errors[name]) {
      setErrors(prev => ({ ...prev, [name]: null }));
    }
  };

  // Handle rating change
  const handleRatingChange = (newRating) => {
    setFormData(prev => ({ ...prev, rating: newRating }));
    if (errors.rating) {
      setErrors(prev => ({ ...prev, rating: null }));
    }
  };

  // Validate form
  const validateForm = () => {
    const newErrors = {};

    // Name validation
    if (!formData.customer_name.trim()) {
      newErrors.customer_name = 'Name is required';
    } else if (formData.customer_name.trim().length < 2) {
      newErrors.customer_name = 'Name must be at least 2 characters';
    }

    // Email validation (optional, but if provided must be valid)
    if (formData.customer_email && !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(formData.customer_email)) {
      newErrors.customer_email = 'Invalid email format';
    }

    // Rating validation
    if (formData.rating === 0) {
      newErrors.rating = 'Please select a rating (1-5 stars)';
    }

    // Review text validation
    if (!formData.review_text.trim()) {
      newErrors.review_text = 'Review text is required';
    } else if (formData.review_text.trim().length < 50) {
      newErrors.review_text = `Review must be at least 50 characters (${formData.review_text.trim().length}/50)`;
    } else if (formData.review_text.length > 1000) {
      newErrors.review_text = 'Review must be less than 1000 characters';
    }

    // Review title validation (optional, max 100)
    if (formData.review_title && formData.review_title.length > 100) {
      newErrors.review_title = 'Title must be less than 100 characters';
    }

    setErrors(newErrors);
    return Object.keys(newErrors).length === 0;
  };

  // Upload photo to Firebase Storage
  const uploadPhoto = async (file) => {
    try {
      const timestamp = Date.now();
      const filename = `review-photos/${timestamp}-${file.name.replace(/[^a-zA-Z0-9.]/g, '_')}`;
      const storageRef = ref(storage, filename);
      
      // Upload file
      const snapshot = await uploadBytes(storageRef, file);
      
      // Get download URL
      const downloadURL = await getDownloadURL(snapshot.ref);
      
      console.log('âœ… Photo uploaded:', downloadURL);
      return downloadURL;
    } catch (error) {
      console.error('âŒ Photo upload failed:', error);
      throw new Error('Failed to upload photo: ' + error.message);
    }
  };

  // Handle form submission
  const handleSubmit = async (e) => {
    e.preventDefault();

    // Validate form
    if (!validateForm()) {
      toast.error('Please fix the errors in the form');
      return;
    }

    setLoading(true);

    try {
      let photoURL = null;

      // Upload photo if provided
      if (photoFile) {
        toast.loading('Uploading photo...', { id: 'photo-upload' });
        photoURL = await uploadPhoto(photoFile);
        toast.success('Photo uploaded!', { id: 'photo-upload' });
      }

      // Submit review to Firestore
      toast.loading('Submitting review...', { id: 'review-submit' });

      const reviewData = {
        customer_name: formData.customer_name.trim(),
        customer_email: formData.customer_email.trim() || null,
        customer_phone: formData.customer_phone.trim() || null,
        customer_avatar: photoURL,
        rating: formData.rating,
        review_title: formData.review_title.trim() || null,
        review_text: formData.review_text.trim(),
        tour_taken: formData.tour_taken,
        booking_date: formData.booking_date ? new Date(formData.booking_date) : null,
        is_approved: false, // Requires admin approval
        is_featured: false,
        source: 'website',
        helpful_votes: 0,
        created_at: serverTimestamp(),
        updated_at: serverTimestamp()
      };

      await addDoc(collection(db, 'testimonials'), reviewData);

      toast.success('Review submitted successfully!', { id: 'review-submit' });
      
      // Show confetti
      setShowConfetti(true);

      // Reset form
      setFormData({
        customer_name: '',
        customer_email: '',
        customer_phone: '',
        rating: 0,
        review_title: '',
        review_text: '',
        tour_taken: 'Full Day Solo Scooter Darshan',
        booking_date: ''
      });
      setPhotoFile(null);
      setPhotoPreview(null);

      // Auto-close modal after 3 seconds
      setTimeout(() => {
        setShowConfetti(false);
        onClose();
      }, 3000);

    } catch (error) {
      console.error('âŒ Review submission failed:', error);
      toast.error('Failed to submit review: ' + error.message);
    } finally {
      setLoading(false);
    }
  };

  return (
    <>
      {/* Confetti Animation */}
      {showConfetti && (
        <Confetti
          width={window.innerWidth}
          height={window.innerHeight}
          recycle={false}
          numberOfPieces={500}
          gravity={0.3}
        />
      )}

      {/* Modal Overlay */}
      <div className="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 overflow-y-auto">
        <div className="bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto relative">
          {/* Close Button */}
          <button
            onClick={onClose}
            className="absolute top-4 right-4 p-2 rounded-full hover:bg-gray-100 transition z-10"
            disabled={loading}
          >
            <X className="h-6 w-6 text-gray-600" />
          </button>

          {/* Header */}
          <div className="px-6 py-8 border-b border-gray-200">
            <div className="text-center">
              <div className="mx-auto h-16 w-16 bg-orange-100 rounded-full flex items-center justify-center mb-4">
                <Star className="h-8 w-8 text-orange-500 fill-orange-500" />
              </div>
              <h2 className="text-3xl font-bold text-gray-900 mb-2">
                Share Your Experience
              </h2>
              <p className="text-gray-600">
                Help others discover the magic of Baba Banarasi through your story
              </p>
            </div>
          </div>

          {/* Form */}
          <form onSubmit={handleSubmit} className="px-6 py-6 space-y-6">
            
            {/* Your Details Section */}
            <div>
              <h3 className="text-lg font-semibold text-gray-900 mb-4">Your Details</h3>
              
              {/* Name */}
              <div className="mb-4">
                <label className="block text-sm font-medium text-gray-700 mb-2">
                  Full Name <span className="text-red-500">*</span>
                </label>
                <input
                  type="text"
                  name="customer_name"
                  value={formData.customer_name}
                  onChange={handleChange}
                  className={`w-full px-4 py-3 border ${errors.customer_name ? 'border-red-500' : 'border-gray-300'} rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent transition`}
                  placeholder="Your name"
                  disabled={loading}
                />
                {errors.customer_name && (
                  <p className="mt-1 text-sm text-red-500">{errors.customer_name}</p>
                )}
              </div>

              {/* Email */}
              <div className="mb-4">
                <label className="block text-sm font-medium text-gray-700 mb-2">
                  Email <span className="text-gray-400">(optional)</span>
                </label>
                <input
                  type="email"
                  name="customer_email"
                  value={formData.customer_email}
                  onChange={handleChange}
                  className={`w-full px-4 py-3 border ${errors.customer_email ? 'border-red-500' : 'border-gray-300'} rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent transition`}
                  placeholder="your@email.com"
                  disabled={loading}
                />
                {errors.customer_email && (
                  <p className="mt-1 text-sm text-red-500">{errors.customer_email}</p>
                )}
                <p className="mt-1 text-xs text-gray-500">
                  ðŸ”’ We'll never share your email publicly
                </p>
              </div>

              {/* Phone */}
              <div className="mb-4">
                <label className="block text-sm font-medium text-gray-700 mb-2">
                  Phone <span className="text-gray-400">(optional)</span>
                </label>
                <input
                  type="tel"
                  name="customer_phone"
                  value={formData.customer_phone}
                  onChange={handleChange}
                  className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent transition"
                  placeholder="+91 98765 43210"
                  disabled={loading}
                />
              </div>
            </div>

            {/* Upload Photo */}
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                Upload Your Photo <span className="text-gray-400">(optional, max 2MB)</span>
              </label>
              
              {photoPreview ? (
                <div className="relative">
                  <img 
                    src={photoPreview} 
                    alt="Preview" 
                    className="w-32 h-32 rounded-full object-cover mx-auto border-4 border-orange-200"
                  />
                  <button
                    type="button"
                    onClick={removePhoto}
                    className="absolute top-0 right-1/2 translate-x-16 bg-red-500 text-white rounded-full p-1.5 hover:bg-red-600 transition"
                    disabled={loading}
                  >
                    <X className="h-4 w-4" />
                  </button>
                </div>
              ) : (
                <div
                  {...getRootProps()}
                  className={`border-2 border-dashed ${isDragActive ? 'border-orange-500 bg-orange-50' : 'border-gray-300'} rounded-lg p-8 text-center cursor-pointer hover:border-orange-500 hover:bg-orange-50 transition`}
                >
                  <input {...getInputProps()} disabled={loading} />
                  <Upload className="h-12 w-12 text-gray-400 mx-auto mb-3" />
                  {isDragActive ? (
                    <p className="text-orange-600 font-medium">Drop your photo here</p>
                  ) : (
                    <>
                      <p className="text-gray-600 mb-1">
                        ðŸ“· Drag & drop or click to upload
                      </p>
                      <p className="text-xs text-gray-500">
                        JPG, PNG, or WebP (max 2MB)
                      </p>
                    </>
                  )}
                </div>
              )}
            </div>

            {/* Rating */}
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                Your Rating <span className="text-red-500">*</span>
              </label>
              <div className="flex justify-center">
                <ReactStars
                  count={5}
                  onChange={handleRatingChange}
                  size={50}
                  activeColor="#f97316"
                  color="#d1d5db"
                  value={formData.rating}
                  edit={!loading}
                />
              </div>
              {formData.rating > 0 && (
                <p className="text-center text-sm text-gray-600 mt-2">
                  You selected: {formData.rating} star{formData.rating !== 1 ? 's' : ''}
                </p>
              )}
              {errors.rating && (
                <p className="text-center mt-1 text-sm text-red-500">{errors.rating}</p>
              )}
            </div>

            {/* Review Title */}
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                Review Title <span className="text-gray-400">(optional, max 100 chars)</span>
              </label>
              <input
                type="text"
                name="review_title"
                value={formData.review_title}
                onChange={handleChange}
                maxLength={100}
                className={`w-full px-4 py-3 border ${errors.review_title ? 'border-red-500' : 'border-gray-300'} rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent transition`}
                placeholder="e.g., Best way to explore Varanasi!"
                disabled={loading}
              />
              <div className="mt-1 flex justify-between text-xs text-gray-500">
                <span>A catchy title helps your review stand out</span>
                <span>{formData.review_title.length}/100</span>
              </div>
              {errors.review_title && (
                <p className="mt-1 text-sm text-red-500">{errors.review_title}</p>
              )}
            </div>

            {/* Review Text */}
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                Your Review <span className="text-red-500">*</span>
              </label>
              <textarea
                name="review_text"
                value={formData.review_text}
                onChange={handleChange}
                rows={5}
                maxLength={1000}
                className={`w-full px-4 py-3 border ${errors.review_text ? 'border-red-500' : 'border-gray-300'} rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent transition resize-none`}
                placeholder="Share your experience with Baba Banarasi. What did you like? How was the guide? Would you recommend it to others? (minimum 50 characters)"
                disabled={loading}
              />
              <div className="mt-1 flex justify-between text-xs">
                <span className={formData.review_text.trim().length < 50 ? 'text-red-500' : 'text-green-600'}>
                  {formData.review_text.trim().length < 50 
                    ? `${50 - formData.review_text.trim().length} more characters needed` 
                    : 'âœ“ Minimum met'}
                </span>
                <span className="text-gray-500">{formData.review_text.length}/1000</span>
              </div>
              {errors.review_text && (
                <p className="mt-1 text-sm text-red-500">{errors.review_text}</p>
              )}
            </div>

            {/* Tour Selection */}
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                Which tour did you take? <span className="text-red-500">*</span>
              </label>
              <select
                name="tour_taken"
                value={formData.tour_taken}
                onChange={handleChange}
                className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent transition"
                disabled={loading}
              >
                <option value="Full Day Solo Scooter Darshan">Full Day Solo Scooter Darshan</option>
                <option value="Morning Session Only">Morning Session Only</option>
                <option value="Afternoon Session Only">Afternoon Session Only</option>
                <option value="Custom Tour">Custom Tour</option>
              </select>
            </div>

            {/* Travel Date */}
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                When did you travel? <span className="text-gray-400">(optional)</span>
              </label>
              <input
                type="date"
                name="booking_date"
                value={formData.booking_date}
                onChange={handleChange}
                max={new Date().toISOString().split('T')[0]}
                className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent transition"
                disabled={loading}
              />
            </div>

            {/* Trust Signals */}
            <div className="bg-blue-50 border border-blue-200 rounded-lg p-4 space-y-2 text-sm text-blue-800">
              <p>âœ… Your review will be verified before publishing</p>
              <p>ðŸ”’ Your email and phone will never be shared publicly</p>
              <p>ðŸ“ All reviews are moderated to ensure authenticity</p>
              <p>â±ï¸ Reviews typically approved within 24 hours</p>
            </div>

            {/* Buttons */}
            <div className="flex gap-4 pt-4">
              <button
                type="button"
                onClick={onClose}
                className="flex-1 px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 font-semibold transition"
                disabled={loading}
              >
                Cancel
              </button>
              <button
                type="submit"
                disabled={loading}
                className="flex-1 px-6 py-3 bg-orange-500 text-white rounded-lg hover:bg-orange-600 font-semibold transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center"
              >
                {loading ? (
                  <>
                    <Loader className="animate-spin h-5 w-5 mr-2" />
                    Submitting...
                  </>
                ) : (
                  'Submit Review'
                )}
              </button>
            </div>
          </form>
        </div>
      </div>
    </>
  );
}
```

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ðŸ”Œ STEP 9: APP ROUTING SETUP (COMPLETE INTEGRATION)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

FILE 9: client/src/App.jsx (Main App with Routing)

```javascript
// client/src/App.jsx
import { BrowserRouter, Routes, Route, Navigate } from 'react-router-dom';
import { Toaster } from 'react-hot-toast';
import { AuthProvider } from './context/AuthContext';
import ProtectedRoute from './components/admin/ProtectedRoute';

// Public Pages
import Home from './pages/Home';
import Tours from './pages/Tours';
import TourDetail from './pages/TourDetail';
import Places from './pages/Places';
import PlaceDetail from './pages/PlaceDetail';
import Reviews from './pages/Reviews';
import About from './pages/About';
import Contact from './pages/Contact';
import NotFound from './pages/NotFound';

// Admin Pages
import AdminLogin from './pages/admin/Login';
import AdminDashboard from './pages/admin/Dashboard';
import ManageBookings from './pages/admin/Bookings';
import ManageTours from './pages/admin/Tours';
import ManagePlaces from './pages/admin/Places';
import ManageReviews from './pages/admin/ManageReviews';
import EditContent from './pages/admin/Content';
import AdminSettings from './pages/admin/Settings';

function App() {
  return (
    <AuthProvider>
      <BrowserRouter>
        <Routes>
          {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
          {/* PUBLIC ROUTES (No Authentication) */}
          {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
          
          <Route path="/" element={<Home />} />
          <Route path="/tours" element={<Tours />} />
          <Route path="/tours/:slug" element={<TourDetail />} />
          <Route path="/places" element={<Places />} />
          <Route path="/places/:slug" element={<PlaceDetail />} />
          <Route path="/reviews" element={<Reviews />} />
          <Route path="/about" element={<About />} />
          <Route path="/contact" element={<Contact />} />

          {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
          {/* ADMIN ROUTES (Protected) */}
          {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
          
          {/* Admin Login (Public - but redirects if already logged in) */}
          <Route path="/admin/login" element={<AdminLogin />} />
          
          {/* Protected Admin Routes */}
          <Route
            path="/admin/dashboard"
            element={
              <ProtectedRoute>
                <AdminDashboard />
              </ProtectedRoute>
            }
          />
          
          <Route
            path="/admin/bookings"
            element={
              <ProtectedRoute>
                <ManageBookings />
              </ProtectedRoute>
            }
          />
          
          <Route
            path="/admin/tours"
            element={
              <ProtectedRoute>
                <ManageTours />
              </ProtectedRoute>
            }
          />
          
          <Route
            path="/admin/places"
            element={
              <ProtectedRoute>
                <ManagePlaces />
              </ProtectedRoute>
            }
          />
          
          <Route
            path="/admin/reviews"
            element={
              <ProtectedRoute>
                <ManageReviews />
              </ProtectedRoute>
            }
          />
          
          <Route
            path="/admin/content"
            element={
              <ProtectedRoute>
                <EditContent />
              </ProtectedRoute>
            }
          />
          
          <Route
            path="/admin/settings"
            element={
              <ProtectedRoute>
                <AdminSettings />
              </ProtectedRoute>
            }
          />

          {/* Admin root redirect */}
          <Route path="/admin" element={<Navigate to="/admin/dashboard" replace />} />

          {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
          {/* 404 NOT FOUND */}
          {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
          
          <Route path="*" element={<NotFound />} />
        </Routes>

        {/* Global Toast Notifications */}
        <Toaster
          position="top-right"
          toastOptions={{
            duration: 4000,
            style: {
              background: '#333',
              color: '#fff',
              borderRadius: '10px',
              padding: '16px',
            },
            success: {
              iconTheme: {
                primary: '#10b981',
                secondary: '#fff',
              },
            },
            error: {
              iconTheme: {
                primary: '#ef4444',
                secondary: '#fff',
              },
            },
          }}
        />
      </BrowserRouter>
    </AuthProvider>
  );
}

export default App;
```

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âœ… STEP 10: FINAL CONFIRMATION CHECKLIST
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

BEFORE DECLARING SUCCESS, VERIFY ALL OF THESE:

FRONTEND CONFIRMATION:
âœ… Website looks PIXEL-PERFECT identical to https://varanasi-scoot-darshan.lovable.app/ 
âœ… All images are the EXACT same (no replacements)
âœ… All colors, fonts, spacing match exactly
âœ… All animations work identically
âœ… Mobile responsive design intact
âœ… Navigation menu identical
Here is the **Actionable Master Prompt** to give to Replit AI. This prompt takes the requirements you provided and converts them into strict coding instructions so the AI builds exactly what you want without messing up the design.

**Copy and paste this into the Replit AI Chat:**

***

```text
Act as a Senior Full-Stack Engineer. I am ready to implement the Backend, Admin Panel, and Database features into this Replit project while keeping the Frontend pixel-perfect.

Here is the MASTER PLAN. Execute these steps strictly. Do not change the visual design of the existing public pages.

### ðŸ“¦ PHASE 1: DEPENDENCIES & SETUP
First, verify or install these specific packages in `package.json`:
`npm install firebase framer-motion react-router-dom react-hot-toast react-icons react-parallax react-intersection-observer react-confetti`

### ðŸ”¥ PHASE 2: FIREBASE CONFIGURATION
Create `src/firebase/config.js`.
- Initialize Firebase App, Firestore, Auth, and Storage.
- Use `import.meta.env` for keys (I will add them to Replit Secrets).
- Export `db`, `auth`, `storage`.

### ðŸ›¡ï¸ PHASE 3: AUTHENTICATION CONTEXT
Create `src/context/AuthContext.jsx`.
- Implement `AuthProvider` wrapping the app.
- Functions: `login(email, password)`, `logout()`.
- State: `currentUser`, `isAdmin` (check against hardcoded admin emails for now to keep it simple, or Firestore user roles).
- Create a `ProtectedRoute` component that redirects non-admins to `/admin/login`.

### ðŸ—„ï¸ PHASE 4: DATABASE & SEEDING (CRITICAL)
Create a script `src/utils/seedDatabase.js` that I can run once to populate Firestore.
1. **`places` Collection:** Create an array of 25 objects (13 Tour Stops + 12 Extra). Each object must have: `name`, `category` (Ghat/Temple), `image_url` (Unsplash link), `description`, `location`.
2. **`testimonials` Collection:** Seed 12 sample reviews with `is_approved: true`.

### ðŸ–¥ï¸ PHASE 5: ADMIN PANEL UI (NEW ROUTE)
Create a new layout at `/admin` that does NOT affect the public site.
1. **Login Page (`/admin/login`):** Simple, clean form.
2. **Dashboard (`/admin`):**
   - **Tabs:** Reviews, Bookings, Places.
   - **Reviews Tab:** Table showing all reviews. Buttons: "Approve", "Delete", "Feature".
   - **Bookings Tab:** List of incoming bookings from the public form.

### â­ PHASE 6: PUBLIC REVIEW SYSTEM INTEGRATION
1. Modify the existing "Write a Review" button on the homepage.
2. Connect it to a Modal containing a form (Name, Rating, Text, Photo).
3. **On Submit:** Save data to Firestore with `is_approved: false`.
4. **Success:** Trigger `react-confetti` and show a Toast notification.
5. **Display:** Update the Testimonials section to only fetch and map reviews from Firestore where `is_approved == true`.

### ðŸš€ PHASE 7: BOOKING FORM LOGIC
1. Connect the existing Booking Form to Firestore `bookings` collection.
2. On submit, save the booking details and show a success message.

### ðŸ“ EXECUTION ORDER:
1. Setup Firebase Config & Context.
2. Build the Admin Login & Dashboard pages.
3. Connect the Public Review Form to backend.
4. Connect the Booking Form to backend.
5. Setup the Data Seeding script.

**Constraints:**
- The public homepage (Navbar, Hero, Tours) must look 100% identical to "https://varanasi-scoot-darshan.lovable.app/ ".
- Do not remove any CSS classes from the existing frontend.
- Use standard Firebase SDK v9+ modular syntax.

Start by setting up the Firebase Config and Auth Context.
```
 And add location on the picture of Explore Holy Varanasi which would be connected to google maps also in booking section in Tour Details
Pickup Location
Add a new choose your hotel and give them option of â€œmy locationâ€ with integrated google maps it will show where is the person 


